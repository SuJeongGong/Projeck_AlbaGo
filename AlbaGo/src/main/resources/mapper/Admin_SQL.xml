<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spring.ex.dao.AdminDAO">
<!-- 공수정 / 메인화면 -->

<!-- 아이템별 기업마다 결제한 횟수-->
<select id="selectCountItem_Enterprise" parameterType= "string" resultType= "hashmap">
	SELECT COUNT(*) AS count, payment.enterprise_id FROM payment,product 
	<where> product.product_id = payment.product_id
	AND  product.`type` = #{item}
	</where>
	group by payment.enterprise_id 
	order BY count DESC
	LIMIT 5
</select>
	<!-- 이예슬 -->
	<!-- 메인일주일매출액  -->
	<select id="selectWeekTotal" resultType="int">
		SELECT  SUM(price) AS sum_price 
		FROM product,payment

		<where>
		product.product_id =payment.product_id 
		AND product.delete_check=1
		AND payment.result="승인"
		AND payment.`date` > (NOW() - INTERVAL 7 DAY)
		</where>
	</select>
	<!-- 개인 -->
	<select id="selectRecentSales" resultType="HashMap">
		SELECT DATE_FORMAT(payment.DATE , "%Y/%m %d") as date, SUM(price) as
		price
		FROM product, payment
		<where>product.product_id
			= payment.product_id
			AND	<![CDATA[	 DATE_FORMAT(payment.DATE , "%Y%m%d") > date_add(now(),interval -7 DAY) ]]>

		</where>
		GROUP BY DATE_FORMAT(payment.DATE , "%Y/%m/%d")
	</select>

	<select id="selectItems" resultType="HashMap">
		SELECT COUNT(*) as count, product.type as type FROM payment,product
		<where> product.product_id = payment.product_id</where>
		group by product.type
	</select>

	<select id="selectlist" resultType="Individual">
		SELECT *
		FROM Individual
	</select>
	
	<select id = "selectId" resultType="Individual" parameterType="String">
		SELECT *
		FROM Individual
	</select>
	
	<select id="selectIdIndividual_id" resultType="Individual" parameterType="String">
	SELECT *
	FROM Individual
	<where>
	individual_id like CONCAT('%',#{individual_id},'%') 
	</where> 
	</select>
	
	<select id="selectIdName" resultType="Individual" parameterType="String">
	SELECT *
	FROM Individual
	<where>
	name like CONCAT('%',#{name},'%') 
	</where> 
	</select>
	
	<select id="selectIdPhone" resultType="Individual" parameterType="String">
	SELECT *
	FROM Individual
	<where>
	phone like CONCAT('%',#{phone},'%')
	</where> 
	</select>
				
	<!-- 개인관리자 링크타고 -->
   <!-- 개인 회원 정보 보기 -->
   <select id="selectIndividualAccount" parameterType="String" resultType="Individual">
   SELECT * 
   FROM Individual
   <where>
   individual_id=#{id}
   </where>
   </select>   
   <!-- 개인 회원 정보 수정 -->
   
   <update id="updateIndividualAccount" parameterType="int">
      update individual 
      set 
         password=#{password},
         name = #{name},
         gender = #{gender},
         birth = #{birth},
         phone = #{phone},
         education = #{education}
      <where>
         individual_id = #{individual_id}
      </where>
   </update>
   <!-- 개인계정정지 -->
   <update id="changestate" parameterType="hashmap">
    update individual 
      set state=#{result}
      <where>
         individual_id = #{individual_id}
      </where>
   </update>
   
   <!-- 이력서관리 -->
   <select id="selectResume" parameterType="String" resultType="Resume">
   SELECT title,date ,resume_id,individual_id
   FROM RESUME 
   <where>
   individual_id=#{id} 
   AND   RESUME.delete_check =1
   </where>    
   </select>
   
   <!-- 이력서관리삭제 ajax -->
   <update id="deleteResume" parameterType="int">
   update resume
   set delete_check = 0
   <where> 
   resume_id=#{resume_id}
   </where>
   </update>
   
   <!-- 지원한 알바 -->
   <select id="selectApplypartjob" parameterType="String" resultType="Volunteer">
   Select
      board_recruit.title as board_recruit_title,
      enterprise.name AS enterprise_name,
      resume.title as resume_title,
      volunteer.date as date,
      volunteer.result as result,
      volunteer.board_recruit_id as board_recruit_id,
      volunteer.individual_id AS individual_id,
      volunteer.volunteer_id,
      board_recruit.delete_check ,
      resume.delete_check 
      FROM resume,volunteer,board_recruit,enterprise,recruit
   <where>
   resume.resume_id =volunteer.resume_id
   AND volunteer.board_recruit_id = board_recruit.board_recruit_id
   AND recruit.recruit_id = board_recruit.recruit_id
   AND enterprise.enterprise_id = recruit.enterprise_id
   AND volunteer.individual_id =#{id}
   AND board_recruit.delete_check =1
   AND resume.delete_check=1
   </where>
   ORDER BY volunteer.volunteer_id DESC
   </select>
   
   <!-- 지원한 알바  취소 AJAX -->
      <delete id="deleteVolunteer" parameterType="int">
      delete from volunteer
      <where>
      volunteer_id=#{volunteer_id}
      </where>
   </delete>
	
	<!-- 인재 게시판 작성글 -->
	<select id="selectResumeWrite" parameterType="String" resultType="BoardResume">
	SELECT 
		board_resume.title AS board_resume_title ,
		resume.title AS resume_title,
		board_resume.memo,
		board_resume.date,
		board_resume.board_resume_id
		
	FROM 
		board_resume,resume,individual

		<where> 
		board_resume.resume_id = resume.resume_id 
		AND resume.individual_id = individual.individual_id
		AND individual.individual_id = #{id}
		AND board_resume.delete_check =1
		</where>
	</select>
	
	<!-- 인재 게시판 취소 AJAX -->
	<update id="deletBoardResume" parameterType="int">
   	update board_resume
   	set delete_check = 0
   	<where> 
   	board_resume_id=#{board_resume_id}
   	</where>
   	</update>

	<!--커뮤니티 게시판 작성글  -->
	<select id="selectCommunity" parameterType="String" resultType="BoardCommunity">
	SELECT 
		community.date AS date,
		 title,
		 individual.name AS name,
		community.community_id
		
		FROM community,individual
		
		<where> community.individual_id=individual.individual_id 
		AND individual.individual_id=#{id}
		</where>
	</select>
	
	<!--커뮤니티 게시판 삭제 AJAX -->
	
	<!-- 커뮤니티글 댓글삭제 -->
	<delete id="deleteComments" parameterType="int">
		DELETE FROM `comment` WHERE `comment`.community_id =#{comment_id}
	</delete>
	
	<!-- 커뮤니티글 글삭제 --> 
	<delete id="deleteCommunity" parameterType="int">
		DELETE FROM community WHERE community_id = #{community_id}
	</delete>
	
	<!-- 기업스크랩 -->
		<select id="selectEnterpriseScrap"  parameterType="String" resultType="Scrap_individual">
		SELECT 
		board_recruit.title AS board_recruit_title,
		recruit.title as recruit_title ,
		recruit.enterprise_id as enterprise_id,
		scrap_individual_id,
		enterprise.name,
		board_recruit.memo,
		scrap_individual.date AS date,
		board_recruit.board_recruit_id
		
		From scrap_individual, board_recruit ,recruit,enterprise
			
		<where>
		scrap_individual.board_recruit_id =board_recruit.board_recruit_id
		AND recruit.recruit_id = board_recruit.recruit_id
		AND recruit.enterprise_id=enterprise.enterprise_id
		AND individual_id =#{id}
		AND board_recruit.delete_check =1
		</where>
		ORDER BY scrap_individual.date DESC
		
		</select>

		<!-- 기업스크랩 취소  -->
	<delete id="deleteEnterpriseScrap" parameterType="int">
		delete from
		Scrap_individual where scrap_individual_id = #{scrap_individual_id}
	</delete>
	
	
<!-- ###################################################################### -->
	<!-- 기업회원 관리자 검색  -->
	<select id = "selectEnterpriselist" resultType="Enterprise" parameterType="String">
		SELECT *
		FROM Enterprise
	</select>

	<select id="selectEnterprise_id" resultType="Enterprise" parameterType="String"> <!-- 기업아이디 -->
	SELECT *
	FROM Enterprise
	<where>
	enterprise_id like CONCAT('%',#{enterprise_id},'%') 
	</where> 
	</select>
	
	<select id="selectEnterprise_name" resultType="Enterprise" parameterType="String"> <!-- 기업이름 -->
	SELECT *
	FROM Enterprise
	<where>
	name like CONCAT('%',#{name},'%') 
	</where> 
	</select>
	
	<select id="selectEnterprise_phone" resultType="Enterprise" parameterType="String"> <!-- 기업전화번호 -->
	SELECT *
	FROM Enterprise
	<where>
	business_number like CONCAT('%',#{business_number},'%') 
	</where> 
	</select>
	
	<select id="selectEnterprise_manager_name" resultType="Enterprise" parameterType="String"> <!-- 담당자이름 -->
	SELECT *
	FROM Enterprise
	<where>
	manager_name like CONCAT('%',#{manager_name},'%') 
	</where> 
	</select>
	
	<select id="selectEnterprise_manager_phone" resultType="Enterprise" parameterType="String"> <!-- 담당자번호-->
	SELECT *
	FROM Enterprise
	<where>
	manager_phone like CONCAT('%',#{manager_phone},'%') 
	</where> 
	</select>
	
	<!-- 기업 회원 정보 -->
	<select id="selectEnterpriseAccount" parameterType="String" resultType="Enterprise">
	SELECT * 
	FROM Enterprise
	<where>
	enterprise_id=#{id}
	</where>
	</select>
	<!-- 기업회원정보수정 -->
	 <update id="updateEnterpriseAccount" parameterType="int">
      update enterprise 
      set 
         password=#{password},
         name = #{name},
         business_number = #{business_number},
         manager_name = #{manager_name},
         manager_phone = #{manager_phone},
         address = #{address},
         category = #{category},
         up_count = #{up_count},
         resume_count = #{resume_count},
         board_recruit_count = #{board_recruit_count}
      <where>
         enterprise_id = #{enterprise_id}
      </where>
   </update>
   
   <!-- 기업 계정정지 -->
   <update id="changeEnterprisestate" parameterType="hashmap">
    update enterprise 
      set state=#{result}
      <where>
         enterprise_id = #{enterprise_id}
      </where>
   </update>
   
	<!-- 공고관리 -->
   <select id="selectRecruit"  parameterType="String" resultType="Recruit">
	 	SELECT recruit.title,recruit.date,recruit.place,recruit.recruit_id,board_recruit.board_recruit_id
		FROM Recruit,board_recruit
		<where>
		Recruit.recruit_id=board_recruit.recruit_id 
		AND 
		enterprise_id = #{id}
	
		AND board_recruit.delete_check=1
		</where>
	</select>
	
	<!-- 공고관리삭제 ajax -->
   <update id="deleteEnterpriseRecruit" parameterType="int">
   update recruit
 	set delete_check = 0
   <where> 
   recruit_id=#{recruit_id}
   </where>
   </update>
   
	
	<!-- 공고게시판 작성글 -->
	<select id="selectRecruitWrite"  parameterType="String" resultType="BoardRecruit">
		SELECT 
		board_recruit.title,
		recruit.title AS recruit_title,
		board_recruit.memo,
		board_recruit.date,board_recruit_id,
		recruit.recruit_id
		

		FROM board_recruit ,recruit,enterprise

		<where>
		board_recruit.recruit_id = recruit.recruit_id 
		AND recruit.enterprise_id = enterprise.enterprise_id
		AND enterprise.enterprise_id = #{id}
		
		AND board_recruit.delete_check =1
		</where>
	</select>
	

   <!-- 공고글 관리 삭제 ajax -->
   	<update id="deleteEnterpriseBoardRecruit" parameterType="int">
	update board_recruit
	set delete_check = 0
	<where>
	board_recruit_id = #{board_recruit_id}
	</where>
	</update>


	
	<!-- 인재스크랩 -->
		<select id="selectScrap"  parameterType="String" resultType="Scrap_enterprise">
	
		SELECT 
		board_resume.title AS board_resume_title,
		resume.title as resume_title ,
		resume.individual_id as individual_id,
		scrap_enterprise_id,
		individual.name,
		board_resume.memo,
		resume.resume_id,
		board_resume.board_resume_id,
		scrap_enterprise.date AS date
		
		From scrap_enterprise, board_resume ,resume,individual
			
		<where>
		scrap_enterprise.board_resume_id =board_resume.board_resume_id
		AND resume.resume_id = board_resume.resume_id
		AND resume.individual_id=individual.individual_id
		AND enterprise_id =#{id}
		AND board_resume.delete_check =1
		</where>
		ORDER BY scrap_enterprise.date DESC
		
		</select>
	<!-- 인재스크랩 취소  -->
	<delete id="deleteScrap" parameterType="int">
		delete from
		Scrap_enterprise where scrap_enterprise_id = #{scrap_id}
	</delete>
	<!-- 상품 결제내역 -->
		<select id="selectPayment"  parameterType="String" resultType="Payment">
	
		SELECT 
		product.name AS name,
		product.price AS product_price,
		product.term AS term,
		payment.date AS date
		FROM payment , enterprise,product
		<where> 
		payment.enterprise_id=enterprise.enterprise_id
		AND payment.product_id=product.product_id
		AND enterprise.enterprise_id=#{id}
		AND product.delete_check =1
		</where>
		</select>
		
		<select id="sumPayment" parameterType="String" resultType="product">
		SELECT  SUM(price) AS sum_price 
		FROM product,payment,enterprise

		<where>  
		product.product_id =payment.product_id 
		AND payment.enterprise_id=enterprise.enterprise_id	
		AND enterprise.enterprise_id=#{id}
		AND product.delete_check=1
		AND payment.result="승인"
		</where>
		</select>	
	
	<!-- #################  -->
	<!-- 임승재  -->
	
	<!-- 총검색  -->
	<select id="total_I" resultType="BoardResume" parameterType="hashmap">
		SELECT *
		FROM individual
		WHERE (individual_id LIKE CONCAT('%',#{search},'%')
		OR name LIKE CONCAT('%',#{search},'%'))
	</select>
	<select id="total_E" resultType="BoardRecruit" parameterType="hashmap">
		SELECT *
		FROM enterprise
		WHERE (enterprise_id LIKE CONCAT('%',#{search},'%')
		OR `NAME` LIKE CONCAT('%',#{search},'%'))
	</select>
	
	<!-- 관리자 메인 오늘 회원가입한 총원 -->
 	<select id="select_TI_join" resultType="int">
		select COUNT(*) AS '개인'
		FROM individual
		WHERE DATE >= CURDATE()
	</select>
	<select id="selet_TE_join" resultType="int">
		select COUNT(*) AS '개인'
		FROM enterprise
		WHERE DATE >= CURDATE()	
	</select> 
	
	<!-- 오늘 매출액 -->
	<select id = "total_M" resultType="hashmap" >
		SELECT DATE_FORMAT(payment.DATE , "%Y/%m/%d") as date, SUM(price) as price
		FROM product, payment
		<![CDATA[
		where product.product_id= payment.product_id
		AND DATE_FORMAT(payment.DATE , "%Y%m%d") >= CURDATE()
		GROUP BY DATE_FORMAT(payment.DATE , "%Y/%m/%d")
		]]>
	</select>
	
	<!-- 예슬이가 아에 감싸는 거라고 설명해줌 -->
	<select id = "recruit_List_id" resultType="BoardRecruit" parameterType="String">
		SELECT 
		board_recruit.board_recruit_id AS board_recruit_id, 
		board_recruit.`date` AS date , 
		board_recruit.title AS title,
		 recruit.enterprise_id AS enterprise_id, 
		 recruit.place AS place, 
		 recruit.category AS category, 
		 recruit.gender AS gender, 
		 recruit.education AS education
		 
		 
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
	</select>
	
	<!-- 전체 공고 갯수 -->
	<select id = "all_Count" resultType="int">
		select count(*)
		from board_recruit
		where board_recruit.delete_check = 1
	</select>
	
	<!-- 오늘 공고 갯수 -->
	<select id = "today_Count" resultType="int">
		select count(*)
		from board_recruit
		where date >= CURDATE()
		and board_recruit.delete_check = 1
	</select>
	
	<!-- 어제 공고 갯수 -->
	<select id = "yesterday_Count" resultType="int">
		select count(*)
		from board_recruit
		<![CDATA[
		where date >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE < CURDATE()
		and board_recruit.delete_check = 1
		]]>
	</select>
	
	<!-- 공고글 게시판 -->
	<select id = "recruit_List" resultType="BoardRecruit">
		SELECT board_recruit.board_recruit_id AS board_recruit_id, board_recruit.`date` AS date , board_recruit.title AS title,
		recruit.enterprise_id AS enterprise_id, recruit.place AS place, recruit.category AS category, recruit.gender AS gender, recruit.education AS education
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
	</select>
	
	<!-- 공고글 전체 검색 -->
	<select id = "total_List_Rc" resultType="BoardRecruit" parameterType="hashmap">
		SELECT board_recruit.board_recruit_id AS board_recruit_id, board_recruit.`date` AS date , board_recruit.title AS title,
		recruit.enterprise_id AS enterprise_id, recruit.place AS place, recruit.category AS category, recruit.gender AS gender, recruit.education AS education
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		and recruit.category like CONCAT('%',#{category},'%')
		and recruit.place like CONCAT('%',#{place},'%')
		and recruit.gender like CONCAT('%',#{gender},'%')
		and recruit.education like CONCAT('%',#{education},'%')
		and (board_recruit.title like CONCAT('%',#{search},'%')
		OR recruit.enterprise_id like CONCAT('%',#{search},'%'))
	</select>
	
	<!-- 공고글 전체 검색 오늘포함 -->
	<select id = "total_List_Rc_T" resultType="BoardRecruit" parameterType="hashmap">
		SELECT board_recruit.board_recruit_id AS board_recruit_id, board_recruit.`date` AS date , board_recruit.title AS title,
		recruit.enterprise_id AS enterprise_id, recruit.place AS place, recruit.category AS category, recruit.gender AS gender, recruit.education AS education
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		and recruit.category like CONCAT('%',#{category},'%')
		and recruit.place like CONCAT('%',#{place},'%')
		and recruit.gender like CONCAT('%',#{gender},'%')
		and recruit.education like CONCAT('%',#{education},'%')
		and board_recruit.date like CONCAT('%',#{day},'%')
		and (board_recruit.title like CONCAT('%',#{search},'%')
		OR recruit.enterprise_id like CONCAT('%',#{search},'%'))
		AND board_recruit.`date` >= CURDATE()
	</select>
	
	<!-- 공고글 전체 검색 일주일포함 -->
	<select id = "total_List_Rc_W" resultType="BoardRecruit" parameterType="hashmap">
		SELECT board_recruit.board_recruit_id AS board_recruit_id, board_recruit.`date` AS date , board_recruit.title AS title,
		recruit.enterprise_id AS enterprise_id, recruit.place AS place, recruit.category AS category, recruit.gender AS gender, recruit.education AS education
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		and recruit.category like CONCAT('%',#{category},'%')
		and recruit.place like CONCAT('%',#{place},'%')
		and recruit.gender like CONCAT('%',#{gender},'%')
		and recruit.education like CONCAT('%',#{education},'%')
		and (board_recruit.title like CONCAT('%',#{search},'%')
		OR recruit.enterprise_id like CONCAT('%',#{search},'%'))
		AND board_recruit.`date` > (NOW() - INTERVAL 7 DAY)
	</select>
	
	<!-- 공고글 전체 검색 일개월포함-->
	<select id = "total_List_Rc_M" resultType="BoardRecruit" parameterType="hashmap">
		SELECT board_recruit.board_recruit_id AS board_recruit_id, board_recruit.`date` AS date , board_recruit.title AS title,
		recruit.enterprise_id AS enterprise_id, recruit.place AS place, recruit.category AS category, recruit.gender AS gender, recruit.education AS education
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		and recruit.category like CONCAT('%',#{category},'%')
		and recruit.place like CONCAT('%',#{place},'%')
		and recruit.gender like CONCAT('%',#{gender},'%')
		and recruit.education like CONCAT('%',#{education},'%')
		and (board_recruit.title like CONCAT('%',#{search},'%')
		OR recruit.enterprise_id like CONCAT('%',#{search},'%'))
		AND board_recruit.`date` > (NOW() - INTERVAL 1 MONTH)
	</select>
	
	<!-- 공고글에서 지원자보기 -->
	<select id="board_list" parameterType="String" resultType="Volunteer">
		SELECT volunteer.board_recruit_id as board_recruit_id,
				volunteer.individual_id as individual_id,
				individual.name AS NAME,
				volunteer.memo as memo,
				volunteer.date as date,
				volunteer.result as result,
				volunteer.resume_id as resume_id,
				volunteer.volunteer_id as volunteer_id
		FROM individual , board_recruit ,volunteer
		WHERE individual.individual_id = volunteer.individual_id
		AND volunteer.board_recruit_id = board_recruit.board_recruit_id
		AND volunteer.board_recruit_id = #{id}
	</select>
	
	<!-- 공고글 삭제 -->
	<update id="deleteBoardRecruits" parameterType="int">
		update board_recruit
		set delete_check = 0
		where board_recruit_id = #{boardrecruit_id}
	</update>
	
	
	<!-- 전체 인재 갯수 -->
	<select id = "all_Count_resume" resultType="int">
		select count(*)
		from board_resume
		where board_resume.delete_check = 1
	</select>
	
	<!-- 오늘 인재 갯수 -->
	<select id = "today_Count_resume" resultType="int">
		select count(*)
		from board_resume
		where date >= CURDATE()
		and board_resume.delete_check = 1
	</select>
	
	<!-- 어제 인재 갯수 -->
	<select id = "yesterday_Count_resume" resultType="int">
		select COUNT(*)
		from board_resume
		<![CDATA[
		where date >= DATE_SUB(CURDATE(), INTERVAL 1 DAY) AND DATE < CURDATE()
		and board_resume.delete_check = 1
		]]>
	</select>
	
	<!-- 인재글 게시판 -->
	<select id = "resume_List" resultType="BoardResume">
		SELECT board_resume.board_resume_id, board_resume.`date`, board_resume.title as board_resume_title,
		 resume.individual_id, resume.category, resume.place,
		 individual.gender, individual.education 
		FROM board_resume, resume, individual
		WHERE board_resume.resume_id = resume.resume_id
		AND resume.individual_id = individual.individual_id
		and board_resume.delete_check = 1
	</select>
	
	<!-- 인재글 전체 검색 -->
	<select id = "total_List_Rs" resultType="BoardResume" parameterType="hashmap">
		SELECT board_resume.board_resume_id, board_resume.`date`, board_resume.title as board_resume_title,
		 resume.individual_id, resume.category, resume.place,
		 individual.gender, individual.education 
		FROM board_resume, resume, individual
		WHERE board_resume.resume_id = resume.resume_id
		AND resume.individual_id = individual.individual_id
		and board_resume.delete_check = 1
		and resume.category like CONCAT('%',#{category},'%')
		and resume.place like CONCAT('%',#{place},'%')
		and individual.gender like CONCAT('%',#{gender},'%')
		and individual.education like CONCAT('%',#{education},'%')
		and (board_resume.title like CONCAT('%',#{search},'%')
		OR resume.individual_id like CONCAT('%',#{search},'%'))
	</select>
	<!-- 인재글 전체 검색 오늘포함 -->
	<select id = "total_List_Rs_T" resultType="BoardResume" parameterType="hashmap">
		SELECT board_resume.board_resume_id, board_resume.`date`, board_resume.title as board_resume_title,
		 resume.individual_id, resume.category, resume.place,
		 individual.gender, individual.education 
		FROM board_resume, resume, individual
		WHERE board_resume.resume_id = resume.resume_id
		AND resume.individual_id = individual.individual_id
		and board_resume.delete_check = 1
		and resume.category like CONCAT('%',#{category},'%')
		and resume.place like CONCAT('%',#{place},'%')
		and individual.gender like CONCAT('%',#{gender},'%')
		and individual.education like CONCAT('%',#{education},'%')
		and (board_resume.title like CONCAT('%',#{search},'%')
		OR resume.individual_id like CONCAT('%',#{search},'%'))
		AND board_resume.`date` >= CURDATE()
	</select>
	<!-- 인재글 전체 검색 일주일포함 -->
	<select id = "total_List_Rs_W" resultType="BoardResume" parameterType="hashmap">
		SELECT board_resume.board_resume_id, board_resume.`date`, board_resume.title as board_resume_title,
		 resume.individual_id, resume.category, resume.place,
		 individual.gender, individual.education 
		FROM board_resume, resume, individual
		WHERE board_resume.resume_id = resume.resume_id
		AND resume.individual_id = individual.individual_id
		and board_resume.delete_check = 1
		and resume.category like CONCAT('%',#{category},'%')
		and resume.place like CONCAT('%',#{place},'%')
		and individual.gender like CONCAT('%',#{gender},'%')
		and individual.education like CONCAT('%',#{education},'%')
		and (board_resume.title like CONCAT('%',#{search},'%')
		OR resume.individual_id like CONCAT('%',#{search},'%'))
		AND board_resume.`date` > (NOW() - INTERVAL 7 DAY)
	</select>
	<!-- 인재글 전체 검색 1개월포함 -->
	<select id = "total_List_Rs_M" resultType="BoardResume" parameterType="hashmap">
		SELECT board_resume.board_resume_id, board_resume.`date`, board_resume.title as board_resume_title,
		 resume.individual_id, resume.category, resume.place,
		 individual.gender, individual.education 
		FROM board_resume, resume, individual
		WHERE board_resume.resume_id = resume.resume_id
		AND resume.individual_id = individual.individual_id
		and board_resume.delete_check = 1
		and resume.category like CONCAT('%',#{category},'%')
		and resume.place like CONCAT('%',#{place},'%')
		and individual.gender like CONCAT('%',#{gender},'%')
		and individual.education like CONCAT('%',#{education},'%')
		and (board_resume.title like CONCAT('%',#{search},'%')
		OR resume.individual_id like CONCAT('%',#{search},'%'))
		AND board_resume.`date` > (NOW() - INTERVAL 1 MONTH)
	</select>
	
	<!-- 예슬이가 아에 감싸는 거라고 설명해줌(인재) -->
	<select id = "resume_List_id" resultType="BoardResume" parameterType="String">
		SELECT board_resume.board_resume_id, board_resume.`date`, board_resume.title as board_resume_title,
		 resume.individual_id, resume.category, resume.place,
		 individual.gender, individual.education 
		FROM board_resume, resume, individual
		WHERE board_resume.resume_id = resume.resume_id
		AND resume.individual_id = individual.individual_id
		and board_resume.delete_check = 1
	</select>
	
	<!-- 인재글 삭제 -->
	<update id="deleteBoardResumes" parameterType="int">
		update board_resume
		set delete_check = 0
		where board_resume_id = #{boardresume_id}
	</update>
	
	
	<!-- 커뮤니티 게시판 -->
	<select id = "community_List" resultType = "BoardCommunity">
		select community.community_id, community.date, community.title, community.individual_id
		from community
	</select>
	
	<!-- 예슬이가 아에 감싸는 거라고 설명해줌 -->
	<select id = "community_List_id" resultType="BoardCommunity" parameterType="String">
		SELECT community.community_id, community.`date`, community.title, community.individual_id
		FROM community
	</select>
	
	<!-- 커뮤니티 전체 검색 -->
	<select id ="community_total_search" resultType="BoardCommunity" parameterType="hashmap">
		SELECT community.community_id, community.`date`, community.title, community.individual_id
		FROM community
		WHERE (community.title like CONCAT('%',#{search},'%')
		OR community.individual_id like CONCAT('%',#{search},'%'))
		and `date` BETWEEN #{start} AND #{end}
	</select>
	
	<!-- 커뮤니티 게시글 삭제 -->
	<delete id="deleteCommunities" parameterType="int">
		delete from community
		where community_id = #{community_id}
	</delete>
	
	<!-- 커뮤니티 댓글 확인 -->
	<select id = "countComment" resultType="int">
		select count(*) 
		from comment 
		where community_id = #{community_id}
	</select>
	
	<!-- 커뮤니티 댓글이 있다면 -->
	<delete id = "deleteComment" parameterType="int">
		delete from comment
		where community_id = #{community_id}
	</delete>
	
	<!-- 커뮤니티 오늘 -->
	<select id = "today_search_C" resultType="BoardCommunity" parameterType="String">
		SELECT community_id, date, title, individual_id
		FROM community
		WHERE date >= CURDATE()
	</select>
	
	<!-- 커뮤니티 일주일 -->
	<select id = "week_search_C" resultType="BoardCommunity" parameterType="String">
		SELECT community_id, date, title, individual_id
		FROM community
		WHERE date > (NOW() - INTERVAL 7 DAY)
	</select>
	
	<!-- 커뮤니티 1개월 -->
	<select id = "month_search_C" resultType="BoardCommunity" parameterType="String">
		SELECT community_id, date, title, individual_id
		FROM community
		WHERE date > (NOW() - INTERVAL 1 MONTH)
	</select>
	
	<!-- 매출 게시판-->
	<select id= "selectPaymentList"  parameterType="String" resultType="Payment">
	SELECT product.price as product_price,
	payment.enterprise_id as enterprise_id,
	payment.date as date,
	product.name as product_name
	
	 FROM payment, product where payment.product_id = product.product_id
	 ORDER BY date DESC
	</select>
	
	<!-- 전체 매출 -->
	<select id = "all_totalsales" resultType="int" >
	  SELECT  SUM(price) AS sum_price 
      FROM product,payment

      where
      product.product_id =payment.product_id 
      AND product.delete_check=1
      AND payment.result="승인"
	</select>
	
	<!-- 오늘 매출 -->
	<select id = "todaysales" resultType="int">
	  SELECT  IFNULL(SUM(price),0) AS sum_price 
      FROM product,payment

      where
      product.product_id =payment.product_id
	  AND `date` >= CURDATE()
      AND product.delete_check=1
      AND payment.result="승인"
	</select>
	
	<!-- 주간 매출 -->
	<select id = "weeklysales" resultType="int">
	SELECT IFNULL(SUM(price),0) AS sum_price 
      FROM product,payment

      where
      product.product_id =payment.product_id
	  AND `date` > (NOW() - INTERVAL 7 DAY)
      AND product.delete_check=1
      AND payment.result="승인"
	</select>
	
</mapper>