<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spring.ex.dao.AdminDAO">
	<!-- 이예슬 -->
	<select id = "selectlist" resultType="Individual">
		SELECT *
		FROM Individual
	</select>
	
	<select id = "selectId" resultType="Individual" parameterType="String">
		SELECT *
		FROM Individual
	</select>
	
	<select id="selectIdIndividual_id" resultType="Individual" parameterType="String">
	SELECT *
	FROM Individual
	<where>
	individual_id like CONCAT('%',#{individual_id},'%') 
	</where> 
	</select>
	
	<select id="selectIdName" resultType="Individual" parameterType="String">
	SELECT *
	FROM Individual
	<where>
	name like CONCAT('%',#{individual_id},'%') 
	</where> 
	</select>
	
	<select id="selectIdPhone" resultType="Individual" parameterType="String">
	SELECT *
	FROM Individual
	<where>
	phone like CONCAT('%',#{phone},'%')
	</where> 
	</select>
				<!-- ................................................. -->
	<!-- 개인관리자 링크타고 -->
	<!-- 개인 회원 정보 -->
	<select id="selectIndividualAccount" parameterType="String" resultType="Individual">
	SELECT * 
	FROM Individual
	<where>
	individual_id=#{id}
	</where>
	</select>	
	<!-- 이력서관리 -->
	<select id="selectResume" parameterType="String" resultType="Resume">
	SELECT title,date 
	FROM RESUME 
	<where>
	individual_id=#{id}
	</where> 	
	</select>
	<!-- 지원한 알바 -->
	<select id="selectApplypartjob" parameterType="String" resultType="Volunteer">
	Select
		board_recruit.title as board_recruit_title,
		enterprise.name AS NAME,
		resume.title as resume_title,
		volunteer.date as date,
		volunteer.result as result
				
		FROM resume,volunteer,board_recruit,enterprise,recruit
	<where>
	resume.resume_id =volunteer.resume_id
	AND volunteer.board_recruit_id = board_recruit.board_recruit_id
	AND recruit.recruit_id = board_recruit.recruit_id
	AND enterprise.enterprise_id = recruit.enterprise_id
	AND volunteer.individual_id =#{id}
	AND board_recruit.delete_check =1
	</where>
	ORDER BY volunteer.volunteer_id DESC
	</select>

	<!-- 인재 게시판 작성글 -->
	<select id="selectResumeWrite" parameterType="String" resultType="BoardResume">
	SELECT 
		board_resume.title AS board_resume_title ,
		resume.title AS resume_title,
		board_resume.memo,
		board_resume.date

		FROM board_resume ,resume,individual

		<where> board_resume.resume_id = resume.resume_id 
		AND resume.individual_id = individual.individual_id
		AND individual.individual_id = #{id}
		AND board_resume.delete_check =1
		</where>
	</select>

	<!-- #################  -->
	<!-- 임승재  -->
	
	<!-- 예슬이가 아에 감싸는 거라고 설명해줌 -->
	<select id = "recruit_List_id" resultType="BoardRecruit" parameterType="String">
		SELECT board_recruit.board_recruit_id, board_recruit.`date`, board_recruit.title, recruit.enterprise_id
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
	</select>
	
	<!-- 작성자로 검색 -->
	<select id = "writer_search" resultType="BoardRecruit" parameterType="String">
		SELECT board_recruit.board_recruit_id, board_recruit.`date`, board_recruit.title, recruit.enterprise_id
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		and recruit.enterprise_id like '%'+#{recruit.enterprise_id}+'%'
	</select>
	
	<!-- 제목으로 검색 -->
	<select id = "title_search" resultType="BoardRecruit" parameterType="String">
		SELECT board_recruit.board_recruit_id, board_recruit.`date`, board_recruit.title, recruit.enterprise_id
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		and board_recruit.title like '%'+#{board_recruit.title}+'%'
	</select>
	
	<!-- 전체 공고 갯수 -->
	<select id = "all_Count" resultType="int">
		select count(*)
		from board_recruit
		where board_recruit.delete_check = 1
	</select>
	
	<!-- 오늘 공고 갯수 -->
	<select id = "today_Count" resultType="int">
		select count(*)
		from board_recruit
		where date >= CURDATE()
		and board_recruit.delete_check = 1
	</select>
	
	<!-- 어제 공고 갯수 -->
	<select id = "yesterday_Count" resultType="int">
		select count(*)
		from board_recruit
		where date > DATE_SUB(NOW(), INTERVAL 1 DAY)
		and board_recruit.delete_check = 1
	</select>
	
	<!-- 공고글 게시판 -->
	<select id = "recruit_List" resultType="BoardRecruit">
		SELECT board_recruit.board_recruit_id, board_recruit.`date`, board_recruit.title, recruit.enterprise_id
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
	</select>
	
	<!-- 공고글 삭제 -->
	<update id="deleteBoardRecruits" parameterType="int">
		update board_recruit
		set delete_check = 0
		where board_recruit_id = #{boardrecruit_id}
	</update>
	
	<!-- 공고글 오늘 -->
	<select id = "today_search_Rc" resultType="BoardRecruit" parameterType="String">
		SELECT board_recruit.board_recruit_id, board_recruit.`date`, board_recruit.title, recruit.enterprise_id
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		AND board_recruit.`date` >= CURDATE()
	</select>
	
	<!-- 공고글 일주일 -->
	<select id = "week_search_Rc" resultType="BoardRecruit" parameterType="String">
		SELECT board_recruit.board_recruit_id, board_recruit.`date`, board_recruit.title, recruit.enterprise_id
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		AND board_recruit.`date` > (NOW() - INTERVAL 7 DAY)
	</select>
	
	<!-- 공고글 1개월 -->
	<select id = "month_search_Rc" resultType="BoardRecruit" parameterType="String">
		SELECT board_recruit.board_recruit_id, board_recruit.`date`, board_recruit.title, recruit.enterprise_id
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
		AND board_recruit.`date` > (NOW() - INTERVAL 1 MONTH)
	</select>
	
	
	
	<!-- 전체 인재 갯수 -->
	<select id = "all_Count_resume" resultType="int">
		select count(*)
		from board_resume
		where board_resume.delete_check = 1
	</select>
	
	<!-- 오늘 인재 갯수 -->
	<select id = "today_Count_resume" resultType="int">
		select count(*)
		from board_resume
		where date >= CURDATE()
		and board_resume.delete_check = 1
	</select>
	
	<!-- 어제 인재 갯수 -->
	<select id = "yesterday_Count_resume" resultType="int">
		select count(*)
		from board_resume
		where date > DATE_SUB(NOW(), INTERVAL 1 DAY)
		and board_resume.delete_check = 1
	</select>
	
	<!-- 인재글 게시판 -->
	<select id = "resume_List" resultType="BoardResume">
		SELECT board_resume.board_resume_id, board_resume.`date`, board_resume.title, resume.individual_id
		FROM board_resume, resume
		WHERE board_resume.resume_id = resume.resume_id
		and board_resume.delete_check = 1
	</select>
	
	<!-- 인재글 삭제 -->
	<update id="deleteBoardResumes" parameterType="int">
		update board_resume
		set delete_check = 0
		where board_resume_id = #{boardresume_id}
	</update>
	
	<!-- 커뮤니티 게시판 -->
	<select id = "community_List" resultType = "BoardCommunity">
		select community.community_id, community.date, community.title, community.individual_id
		from community
	</select>
	
	<!-- 예슬이가 아에 감싸는 거라고 설명해줌 -->
	<select id = "community_List_id" resultType="BoardCommunity" parameterType="String">
		SELECT board_recruit.board_recruit_id, board_recruit.`date`, board_recruit.title, recruit.enterprise_id
		FROM board_recruit, recruit
		WHERE board_recruit.recruit_id = recruit.recruit_id
		and board_recruit.delete_check = 1
	</select>
	
	<!-- 작성자로 검색 -->
	<select id = "writer_search_C" resultType="BoardCommunity" parameterType="String">
		SELECT community.community_id, community.`date`, community.title, community.individual_id
		FROM community
		WHERE individual_id like CONCAT('%',#{individual_id},'%')
	</select>
	
	<!-- 제목으로 검색 -->
	<select id = "title_search_C" resultType="BoardCommunity" parameterType="String">
		SELECT community.community_id, community.`date`, community.title, community.individual_id
		FROM community
		WHERE title like CONCAT('%',#{title},'%')
	</select>
	
	<!-- 커뮤니티 게시글 삭제 -->
	<delete id="deleteCommunities" parameterType="int">
		delete from community
		where community_id = #{community_id}
	</delete>
	
	<!-- 커뮤니티 댓글 확인 -->
	<select id = "countComment" resultType="int">
		select count(*) 
		from comment 
		where community_id = #{community_id}
	</select>
	
	<!-- 커뮤니티 댓글이 있다면 -->
	<delete id = "deleteComment" parameterType="int">
		delete from comment
		where community_id = #{community_id}
	</delete>
	
	<!-- 커뮤니티 오늘 -->
	<select id = "today_search_C" resultType="BoardCommunity" parameterType="String">
		SELECT community_id, date, title, individual_id
		FROM community
		WHERE date >= CURDATE()
	</select>
	
	<!-- 커뮤니티 일주일 -->
	<select id = "week_search_C" resultType="BoardCommunity" parameterType="String">
		SELECT community_id, date, title, individual_id
		FROM community
		WHERE date > (NOW() - INTERVAL 7 DAY)
	</select>
	
	<!-- 커뮤니티 1개월 -->
	<select id = "month_search_C" resultType="BoardCommunity" parameterType="String">
		SELECT community_id, date, title, individual_id
		FROM community
		WHERE date > (NOW() - INTERVAL 1 MONTH)
	</select>
</mapper>